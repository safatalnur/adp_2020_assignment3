import*as e from"react";import{createContext as r,useContext as t,createElement as n,useState as s,useRef as c,useEffect as u,isValidElement as i,cloneElement as a,Fragment as o}from"react";var l=e=>void 0===e,f=e=>null===e||l(e),d=e=>Array.isArray(e);const g=e=>"object"==typeof e;var m=e=>!f(e)&&!d(e)&&g(e),h=e=>m(e)&&e.nodeType===Node.ELEMENT_NODE;const v={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit"},b="undefined",p={BLUR:"blur",CHANGE:"change",INPUT:"input"},y="max",O="min",j="maxLength",S="minLength",w="pattern",x="required",R="validate",V=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,E=/^\w*$/,B=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,N=/\\(\\)?/g;var F=e=>!d(e)&&(E.test(e)||!V.test(e)),C=e=>{const r=[];return e.replace(B,(e,t,n,s)=>{r.push(n?s.replace(N,"$1"):t||e)}),r};function k(e,r,t){let n=-1;const s=F(r)?[r]:C(r),c=s.length,u=c-1;for(;++n<c;){const r=s[n];let c=t;if(n!==u){const t=e[r];c=m(t)||d(t)?t:isNaN(s[n+1])?{}:[]}e[r]=c,e=e[r]}return e}var L=e=>Object.entries(e).reduce((e,[r,t])=>F(r)?Object.assign(Object.assign({},e),{[r]:t}):(k(e,r,t),e),{}),$=(e,r,t)=>{const n=r.split(/[,[\].]+?/).filter(Boolean).reduce((e,r)=>f(e)?e:e[r],e);return l(n)||n===e?e[r]||t:n},A=(e,r)=>{for(const t in e)if($(r,t)){const r=e[t];if(r){if(h(r.ref)&&r.ref.focus){r.ref.focus();break}if(r.options){r.options[0].ref.focus();break}}}},P=(e,r)=>{h(e)&&e.removeEventListener&&(e.removeEventListener(p.INPUT,r),e.removeEventListener(p.CHANGE,r),e.removeEventListener(p.BLUR,r))},M=e=>!!e&&"radio"===e.type,W=e=>!!e&&"checkbox"===e.type;function D(e){return!e||e instanceof HTMLElement&&e.nodeType!==Node.DOCUMENT_NODE&&D(e.parentNode)}var I=e=>m(e)&&!Object.keys(e).length;function T(e){return d(e)?e:C(e)}function U(e,r){return 1==r.length?e:function(e,r){const t=F(r)?[r]:T(r),n=r.length;let s=0;for(;s<n;)e=l(e)?s++:e[t[s++]];return s==n?e:void 0}(e,function(e,r,t){let n=-1,s=e.length;r<0&&(r=-r>s?0:s+r),(t=t>s?s:t)<0&&(t+=s),s=r>t?0:t-r;const c=Array(s);for(;++n<s;)c[n]=e[n+r];return c}(r,0,-1))}function z(e,r){return r.forEach(r=>{!function(e,r){const t=F(r)?[r]:T(r),n=U(e,t),s=t[t.length-1],c=!(null!=n)||delete n[s];let u=void 0;for(let r=0;r<t.slice(0,-1).length;r++){let n=-1,s=void 0;const c=t.slice(0,-(r+1)),i=c.length-1;for(r>0&&(u=e);++n<c.length;){const r=c[n];s=s?s[r]:e[r],i===n&&(m(s)&&I(s)?u?delete u[r]:delete e[r]:d(s)&&!s.filter(e=>m(e)&&!I(e)).length&&u&&delete u[r]),u=s}}}(e,r)}),e}const H={isValid:!1,value:""};var G=e=>d(e)?e.reduce((e,{ref:{checked:r,value:t}})=>r?{isValid:!0,value:t}:e,H):H,q=e=>[...e].filter(({selected:e})=>e).map(({value:e})=>e),_=e=>!!e&&"file"===e.type,J=e=>!!e&&"select-multiple"===e.type,K=e=>""===e;const Q={value:!1,isValid:!1},X={value:!0,isValid:!0};var Y=e=>{if(d(e)){if(e.length>1){const r=e.filter(({ref:{checked:e}})=>e).map(({ref:{value:e}})=>e);return{value:r,isValid:!!r.length}}const{checked:r,value:t,attributes:n}=e[0].ref;return r?n&&!l(n.value)?l(t)||K(t)?X:{value:t,isValid:!0}:X:Q}return Q};function Z(e,r){const{name:t,value:n}=r,s=e[t];return _(r)?r.files:M(r)?s?G(s.options).value:"":J(r)?q(r.options):W(r)?!!s&&Y(s.options).value:n}var ee=e=>"string"==typeof e,re=(e,r)=>{const t={},n=ee(r),s=d(r),c=r&&r.nest;for(const u in e)(l(r)||c||n&&u.startsWith(r)||s&&r.find(e=>u.startsWith(e)))&&(t[u]=Z(e,e[u].ref));return t},te=(e,{type:r,types:t,message:n})=>m(e)&&e.type===r&&e.message===n&&((e={},r={})=>Object.entries(e).reduce((e,[t,n])=>!!e&&r[t]&&r[t]===n,!0))(e.types,t);var ne=e=>e instanceof RegExp,se=e=>{const r=m(e)&&!ne(e);return{value:r?e.value:e,message:r?e.message:""}},ce=e=>"function"==typeof e,ue=e=>"boolean"==typeof e;function ie(e,r,t="validate"){const n=ee(e);if(n||ue(e)&&!e){return{type:t,message:n?e:"",ref:r}}}var ae=(e,r,t,n,s)=>{if(!r)return{};const c=t[e];return Object.assign(Object.assign({},c),{types:Object.assign(Object.assign({},c&&c.types?c.types:{}),{[n]:s||!0})})},oe=async(e,r,{ref:t,ref:{type:n,value:s,name:c},options:u,required:i,maxLength:a,minLength:o,min:l,max:d,pattern:g,validate:h})=>{const v=e.current,b={},p=M(t),V=W(t),E=p||V,B=K(s),N=ae.bind(null,c,r,b),F=(e,n,s,u=j,i=S)=>{const a=e?n:s;if(b[c]=Object.assign({type:e?u:i,message:a,ref:t},N(e?u:i,a)),!r)return b};if(i&&(!p&&!V&&(B||f(s))||ue(s)&&!s||V&&!Y(u).isValid||p&&!G(u).isValid)){const{value:e,message:n}=ee(i)?{value:!!i,message:i}:se(i);if(e&&(b[c]=Object.assign({type:x,message:n,ref:E?v[c].options[0].ref:t},N(x,n)),!r))return b}if(!f(l)||!f(d)){let e,c;const{value:u,message:i}=se(d),{value:a,message:o}=se(l);if("number"===n||!n&&!isNaN(s)){const r=t.valueAsNumber||parseFloat(s);f(u)||(e=r>u),f(a)||(c=r<a)}else{const r=t.valueAsDate||new Date(s);ee(u)&&(e=r>new Date(u)),ee(a)&&(c=r<new Date(a))}if((e||c)&&(F(!!e,i,o,y,O),!r))return b}if(ee(s)&&!B&&(a||o)){const{value:e,message:t}=se(a),{value:n,message:c}=se(o),u=s.toString().length,i=a&&u>e,l=o&&u<n;if((i||l)&&(F(!!i,t,c),!r))return b}if(g&&!B){const{value:e,message:n}=se(g);if(ne(e)&&!e.test(s)&&(b[c]=Object.assign({type:w,message:n,ref:t},N(w,n)),!r))return b}if(h){const e=Z(v,t),n=E&&u?u[0].ref:t;if(ce(h)){const t=ie(await h(e),n);if(t&&(b[c]=Object.assign(Object.assign({},t),N(R,t.message)),!r))return b}else if(m(h)){const t=Object.entries(h),s=await new Promise(s=>{t.reduce(async(u,[i,a],o)=>{if(!I(await u)&&!r||!ce(a))return s(u);let l;const f=ie(await a(e),n,i);return f?(l=Object.assign(Object.assign({},f),N(i,f.message)),r&&(b[c]=l)):l=u,t.length-1===o?s(l):l},{})});if(!I(s)&&(b[c]=Object.assign({ref:n},s),!r))return b}}return b};const le=(e,r)=>d(e.inner)?e.inner.reduce((e,{path:t,message:n,type:s})=>Object.assign(Object.assign({},e),e[t]&&r?{[t]:ae(t,r,e,s,n)}:{[t]:e[t]||Object.assign({message:n,type:s},r?{types:{[s]:n||!0}}:{})}),{}):{[e.path]:{message:e.message,type:e.type}};async function fe(e,r,t,n,s){if(n)return n(t,s);try{return{values:await e.validate(t,{abortEarly:!1,context:s}),errors:{}}}catch(e){return{values:{},errors:L(le(e,r))}}}var de=(e,r,t)=>l(e[r])?$(e,r,t):e[r];var ge=e=>f(e)||!g(e);const me=(e,r)=>{const t=(r,t,n)=>{const s=n?`${e}.${t}`:`${e}[${t}]`;return ge(r)?s:me(s,r)};return d(r)?r.map((e,r)=>t(e,r)):Object.entries(r).map(([e,r])=>t(r,e,!0))};var he=(e,r)=>(function e(r){return r.reduce((r,t)=>r.concat(d(t)?e(t):t),[])})(me(e,r)),ve=(e,r,t,n,s)=>{let c;return t.add(r),I(e)?c=s||void 0:l(e[r])?(c=$(L(e),r),d(s)&&d(c)&&c.length!==s.length&&(c=s),l(c)||he(r,c).forEach(e=>t.add(e))):(c=e[r],t.add(r)),l(c)?m(n)?de(n,r):n:c},be=({hasError:e,isBlurEvent:r,isOnSubmit:t,isReValidateOnSubmit:n,isOnBlur:s,isReValidateOnBlur:c,isSubmitted:u})=>t&&n||t&&!u||s&&!r&&!e||c&&!r&&e||n&&u,pe=(e,r)=>{const t=L(re(e));return r?$(t,r,t):t};function ye(e,r){let t=!1;if(!d(e)||!d(r)||e.length!==r.length)return!0;for(let n=0;n<e.length&&!t;n++){const s=e[n],c=r[n];if(l(c)||Object.keys(s).length!==Object.keys(c).length){t=!0;break}for(const e in s)if(s[e]!==c[e]){t=!0;break}}return t}const Oe=(e,r)=>e.startsWith(`${r}[`);var je=(e,r)=>[...e].reduce((e,t)=>!!Oe(r,t)||e,!1),Se=e=>typeof FileList!==b&&e instanceof FileList;var we=e=>({isOnSubmit:!e||e===v.onSubmit,isOnBlur:e===v.onBlur,isOnChange:e===v.onChange});const{useRef:xe,useState:Re,useCallback:Ve,useEffect:Ee}=e;function Be({mode:e=v.onSubmit,reValidateMode:r=v.onChange,validationSchema:t,validationResolver:n,validationContext:s,defaultValues:c={},submitFocusError:u=!0,validateCriteriaMode:i}={}){const a=xe({}),o="all"===i,g=xe({}),y=xe({}),O=xe({}),j=xe(new Set),S=xe(new Set),w=xe(new Set),x=xe(new Set),R=xe(!0),V=xe({}),E=xe(c),B=xe(!1),N=xe(!1),C=xe(!1),T=xe(!1),U=xe(0),H=xe(!1),G=xe(),q=xe({}),Q=xe(s),X=xe(new Set),[,Y]=Re(),{isOnBlur:ne,isOnSubmit:se}=xe(we(e)).current,ie=typeof window===b,ae=!(!t&&!n),le=typeof document!==b&&!ie&&!l(window.HTMLElement),me=le&&"Proxy"in window,he=xe({dirty:!me,dirtyFields:!me,isSubmitted:se,submitCount:!me,touched:!me,isSubmitting:!me,isValid:!me}),{isOnBlur:Oe,isOnSubmit:Be}=xe(we(r)).current,Ne=Ve(()=>{B.current||Y({})},[]),Fe=Ve((e,r,t,n)=>{let s=t||function({errors:e,name:r,error:t,validFields:n,fieldsWithValidation:s}){const c=I(t),u=I(e),i=$(t,r),a=$(e,r);return!(c&&n.has(r)||a&&a.isManual)&&(!!(u!==c||!u&&!a||c&&s.has(r)&&!n.has(r))||i&&!te(a,i))}({errors:g.current,error:r,name:e,validFields:x.current,fieldsWithValidation:w.current});if(I(r)?((w.current.has(e)||ae)&&(x.current.add(e),s=s||$(g.current,e)),g.current=z(g.current,[e])):(x.current.delete(e),s=s||!$(g.current,e),k(g.current,e,r[e])),s&&!n)return Ne(),!0},[Ne,ae]),Ce=Ve((e,r)=>{const t=e.ref,n=e.options,{type:s}=t,c=le&&h(t)&&f(r)?"":r;return M(t)&&n?n.forEach(({ref:e})=>e.checked=e.value===c):_(t)?K(c)||Se(c)?t.files=c:t.value=c:J(t)?[...t.options].forEach(e=>e.selected=c.includes(e.value)):W(t)&&n?n.length>1?n.forEach(({ref:e})=>e.checked=c.includes(e.value)):n[0].ref.checked=!!c:t.value=c,!!s},[le]),ke=e=>{if(!a.current[e]||!he.current.dirty&&!he.current.dirtyFields)return!1;const r=je(X.current,e),t=S.current.size;let n=V.current[e]!==Z(a.current,a.current[e].ref);if(r){const r=e.substring(0,e.indexOf("["));n=ye(pe(a.current,r),$(E.current,r))}const s=(r?T.current:S.current.has(e))!==n;return n?S.current.add(e):S.current.delete(e),T.current=r?n:!!S.current.size,he.current.dirty?s:t!==S.current.size},Le=Ve(e=>{if(ke(e)||!$(y.current,e)&&he.current.touched)return!!k(y.current,e,!0)},[]),$e=Ve((e,r,t)=>{const n=d(r);for(const s in r){const c=`${t||e}${n?`[${s}]`:`.${s}`}`;m(r[s])&&$e(e,r[s],c);const u=a.current[c];u&&(Ce(u,r[s]),Le(c))}},[Ce,Le]),Ae=Ve((e,r)=>{const t=a.current[e];if(t){Ce(t,r);const n=Le(e);if(ue(n))return n}else ge(r)||$e(e,r)},[Le,Ce,$e]),Pe=Ve(async(e,r)=>{const t=a.current[e];if(!t)return!1;const n=await oe(a,o,t);return Fe(e,n,!1,r),I(n)},[Fe,o]),Me=Ve(async e=>{const{errors:r}=await fe(t,o,pe(a.current),n,Q.current),s=R.current;return R.current=I(r),d(e)?(e.forEach(e=>{const t=$(r,e);t?k(g.current,e,t):z(g.current,[e])}),Ne()):Fe(e,$(r,e)?{[e]:$(r,e)}:{},s!==R.current),I(g.current)},[Ne,Fe,o,n,t]),We=Ve(async e=>{const r=e||Object.keys(a.current);if(ae)return Me(r);if(d(r)){const e=await Promise.all(r.map(async e=>await Pe(e,!0)));return Ne(),e.every(Boolean)}return await Pe(r)},[Me,Pe,Ne,ae]),De=e=>{const r=(e.match(/\w+/)||[])[0];return N.current||j.current.has(e)||j.current.has(r)&&!F(e)&&X.current.has(r)};function Ie(e,r,t){let n=!1;const s=d(e);(s?e:[e]).forEach(e=>{const t=ee(e);n=!(!Ae(t?e:Object.keys(e)[0],t?r:Object.values(e)[0])&&!s)||De(e)}),(n||s)&&Ne(),(t||s&&r)&&We(s?void 0:e)}G.current=G.current?G.current:async({type:e,target:r})=>{const s=r?r.name:"",c=a.current,u=g.current,i=c[s],l=$(u,s);let f;if(!i)return;const d=e===p.BLUR,m=be({hasError:!!l,isBlurEvent:d,isOnSubmit:se,isReValidateOnSubmit:Be,isOnBlur:ne,isReValidateOnBlur:Oe,isSubmitted:C.current}),h=ke(s);let v=De(s)||h;if(d&&!$(y.current,s)&&he.current.touched&&(k(y.current,s,!0),v=!0),m)return v&&Ne();if(ae){const{errors:e}=await fe(t,o,pe(c),n,Q.current),r=R.current;R.current=I(e),f=$(e,s)?{[s]:$(e,s)}:{},r!==R.current&&(v=!0)}else f=await oe(a,o,i);!Fe(s,f)&&v&&Ne()};const Te=Ve((e={})=>{const r=I(E.current)?re(a.current):E.current;fe(t,o,L(Object.assign(Object.assign({},r),e)),n,Q.current).then(({errors:e})=>{const r=R.current;R.current=I(e),r!==R.current&&Ne()})},[Ne,o,n]),Ue=(e,r)=>{!l(G.current)&&e&&function(e,r,t,n){if(!t)return;const{ref:s,ref:{name:c,type:u},mutationWatcher:i}=t;if(!u)return void delete e[c];const a=e[c];if((M(s)||W(s))&&a){const{options:t}=a;d(t)&&t.length?(t.forEach(({ref:e,mutationWatcher:s},c)=>{(e&&D(e)||n)&&(P(e,r),s&&s.disconnect(),z(t,[`[${c}]`]))}),t&&!t.filter(Boolean).length&&delete e[c]):delete e[c]}else(D(s)||n)&&(P(s,r),i&&i.disconnect(),delete e[c])}(a.current,G.current,e,r)},ze=Ve((e,r)=>{if(!e||e&&je(X.current,e.ref.name)&&!r)return;Ue(e,r);const{name:t}=e.ref;g.current=z(g.current,[t]),y.current=z(y.current,[t]),V.current=z(V.current,[t]),[S,w,x,j].forEach(e=>e.current.delete(t)),(he.current.isValid||he.current.touched)&&(Ne(),ae&&Te())},[Ne,ae,Te]);const He=({name:e,type:r,types:t,message:n,preventRender:s})=>{const c=a.current[e];te(g.current[e],{type:r,message:n,types:t})||(k(g.current,e,{type:r,types:t,message:n,ref:c?c.ref:{},isManual:!0}),s||Ne())};function Ge(e){I(a.current)||(d(e)?e:[e]).forEach(e=>ze(a.current[e],!0))}function qe(e,r={}){if(!e.name)return console.warn("Missing name @",e);const{name:t,type:n,value:s}=e,c=Object.assign({ref:e},r),u=a.current,i=M(e)||W(e);let f,g=u[t],m=!0,v=!1;if(i?g&&d(g.options)&&g.options.find(({ref:e})=>s===e.value):g)return void(u[t]=Object.assign(Object.assign({},g),r));if(n){const s=function(e,r){const t=new MutationObserver(()=>{D(e)&&(t.disconnect(),r())});return t.observe(window.document,{childList:!0,subtree:!0}),t}(e,()=>ze(c));g=i?Object.assign({options:[...g&&g.options||[],{ref:e,mutationWatcher:s}],ref:{type:n,name:t}},r):Object.assign(Object.assign({},c),{mutationWatcher:s})}else g=c;if(u[t]=g,I(E.current)||(f=de(E.current,t),m=l(f),v=je(X.current,t),m||v||Ce(g,f)),ae&&!v&&he.current.isValid?Te():I(r)||(w.current.add(t),!se&&he.current.isValid&&oe(a,o,g).then(e=>{const r=R.current;I(e)?x.current.add(t):R.current=!1,r!==R.current&&Ne()})),V.current[t]||v&&m||(V.current[t]=m?Z(u,g.ref):f),!n)return;!function({field:e,handleChange:r,isRadioOrCheckbox:t}){const{ref:n}=e;h(n)&&n.addEventListener&&r&&(n.addEventListener(t?p.CHANGE:p.INPUT,r),n.addEventListener(p.BLUR,r))}({field:i&&g.options?g.options[g.options.length-1]:g,isRadioOrCheckbox:i,handleChange:G.current})}function _e(e,r){if(!ie)if(ee(e))qe({name:e},r);else{if(!(m(e)&&"name"in e))return r=>r&&qe(r,e);qe(e,r)}}const Je=Ve(e=>async r=>{let s,c;r&&(r.preventDefault(),r.persist());const i=a.current;he.current.isSubmitting&&(H.current=!0,Ne());try{if(ae){c=re(i);const{errors:e,values:r}=await fe(t,o,L(c),n,Q.current);g.current=e,s=e,c=r}else{const{errors:e,values:r}=await Object.values(i).reduce(async(e,r)=>{if(!r)return e;const t=await e,{ref:n,ref:{name:s}}=r;if(!i[s])return Promise.resolve(t);const c=await oe(a,o,r);return c[s]?(k(t.errors,s,c[s]),x.current.delete(s),Promise.resolve(t)):(w.current.has(s)&&x.current.add(s),t.values[s]=Z(i,n),Promise.resolve(t))},Promise.resolve({errors:{},values:{}}));s=e,c=r}I(s)?(g.current={},await e(L(c),r)):(u&&le&&A(i,s),g.current=s)}finally{C.current=!0,H.current=!1,U.current=U.current+1,Ne()}},[le,Ne,ae,u,o,n,t]),Ke=e=>{const r=re(a.current),t=I(r)?E.current:r;return e&&e.nest?L(t):t};Ee(()=>()=>{B.current=!0,a.current&&Object.values(a.current).forEach(e=>ze(e,!0))},[ze]),ae||(R.current=x.current.size>=w.current.size&&I(g.current));const Qe={dirty:T.current,dirtyFields:S.current,isSubmitted:C.current,submitCount:U.current,touched:y.current,isSubmitting:H.current,isValid:se?C.current&&I(g.current):R.current};return{watch:function(e,r){const t=l(r)?l(E.current)?{}:E.current:r,n=re(a.current,e),s=j.current;if(ee(e))return ve(n,e,s,t,X.current.has(e)?O.current[e]:void 0);if(d(e))return e.reduce((e,r)=>Object.assign(Object.assign({},e),{[r]:ve(n,r,s,t)}),{});N.current=!0;const c=!I(n)&&n||r||E.current;return e&&e.nest?L(c):c},control:Object.assign(Object.assign({register:_e,unregister:Ge,removeFieldEventListener:Ue,getValues:Ke,setValue:Ie,reRender:Ne,triggerValidation:We},ae?{validateSchemaIsValid:Te}:{}),{formState:Qe,mode:{isOnBlur:ne,isOnSubmit:se},reValidateMode:{isReValidateOnBlur:Oe,isReValidateOnSubmit:Be},errorsRef:g,touchedFieldsRef:y,fieldsRef:a,resetFieldArrayFunctionRef:q,validFieldsRef:x,dirtyFieldsRef:S,fieldsWithValidationRef:w,watchFieldArrayRef:O,fieldArrayNamesRef:X,isDirtyRef:T,readFormStateRef:he,defaultValuesRef:E}),handleSubmit:Je,setValue:Ve(Ie,[Ne,Ae,We]),triggerValidation:We,getValues:Ve(Ke,[]),reset:Ve((e,r={})=>{if(le)for(const e of Object.values(a.current))if(e&&h(e.ref)&&e.ref.closest)try{e.ref.closest("form").reset();break}catch(e){}e&&(E.current=e),Object.values(q.current).forEach(e=>ce(e)&&e()),(({errors:e,dirty:r,isSubmitted:t,touched:n,isValid:s,submitCount:c})=>{a.current={},e||(g.current={}),n||(y.current={}),s||(x.current=new Set,w.current=new Set,R.current=!0),r||(S.current=new Set,T.current=!1),t||(C.current=!1),c||(U.current=0),V.current={},j.current=new Set,N.current=!1})(r),Ne()},[]),register:Ve(_e,[E.current,V.current,O.current]),unregister:Ve(Ge,[]),clearError:Ve(function(e){l(e)?g.current={}:z(g.current,d(e)?e:[e]),Ne()},[]),setError:Ve(function(e,r="",t){ee(e)?He(Object.assign({name:e},m(r)?{types:r,type:""}:{type:r,message:t})):d(e)&&(e.forEach(e=>He(Object.assign(Object.assign({},e),{preventRender:!0}))),Ne())},[]),errors:g.current,formState:me?new Proxy(Qe,{get:(e,r)=>r in e?(he.current[r]=!0,e[r]):{}}):Qe}}function Ne(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var s=0;for(n=Object.getOwnPropertySymbols(e);s<n.length;s++)r.indexOf(n[s])<0&&Object.prototype.propertyIsEnumerable.call(e,n[s])&&(t[n[s]]=e[n[s]])}return t}const Fe=r(null);function Ce(){const e=t(Fe);return l(e)&&console.warn("Missing FormContext"),e}function ke(e){var{children:r,formState:t,errors:s}=e,c=Ne(e,["children","formState","errors"]);return n(Fe.Provider,{value:Object.assign(Object.assign({},c),{formState:t,errors:s})},r)}var Le=()=>{const e=typeof performance===b?Date.now():1e3*performance.now();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(r){const t=(16*Math.random()+e)%16|0;return("x"==r?t:3&t|8).toString(16)})};const $e=(e,r)=>Object.assign(Object.assign({},m(e)?e:{value:e}),{[r]:Le()}),Ae=(e,r)=>(d(e)?e:[]).map(e=>$e(e,r)),Pe=(e,r)=>[...e.slice(0,r),...e.slice(r+1)];var Me=(e,r)=>l(r)?[]:d(r)?r.reduce(({result:e,previousIndex:r},t)=>({result:Pe(e,r>-1&&r<t?t-1:t),previousIndex:t}),{result:e,previousIndex:-1}).result:Pe(e,r),We=(e,r,t)=>d(e)?e.splice(t,0,e.splice(r,1)[0]):[],De=(e,r,t)=>d(e)&&([e[r],e[t]]=[e[t],e[r]]),Ie=(e,r)=>[...d(r)?r:[r||null],...e],Te=(e,r,t)=>[...e.slice(0,r),...d(t)?t:[t||null],...e.slice(r)],Ue=e=>d(e)?Array(e.length).fill(null):void 0;const{useEffect:ze,useCallback:He,useRef:Ge,useState:qe}=e,_e=({control:e,name:r,keyName:t="id"})=>{const n=Ce(),{resetFieldArrayFunctionRef:s,fieldArrayNamesRef:c,reRender:u,fieldsRef:i,getValues:a,defaultValuesRef:o,removeFieldEventListener:f,errorsRef:g,dirtyFieldsRef:m,isDirtyRef:h,touchedFieldsRef:v,readFormStateRef:b,watchFieldArrayRef:p,validFieldsRef:y,fieldsWithValidationRef:O,validateSchemaIsValid:j}=e||n.control,S=Ge($(o.current,r,[])),[w,x]=qe(Ae(S.current,t)),R=Ge(w),V=e=>e.map(e=>$e(e,t));R.current=w;const E=e=>{p.current=Object.assign(Object.assign({},p.current),{[r]:e}),x(e),b.current.isValid&&j&&j({[r]:e})},B=e=>{b.current.dirty&&(h.current=!!l(e)||ye(e,S.current));for(const e in i.current)Oe(e,r)&&i.current[e]&&f(i.current[e],!0)},N=()=>{const e=a({nest:!0})[r];if(d(e))for(let r=0;r<e.length;r++)w[r]=Object.assign(Object.assign({},w[r]),e[r])},F=()=>{B(),S.current=$(o.current,r,[]),x(Ae(S.current,t))};return ze(()=>{const e=s.current,t=c.current;return t.add(r),e[r]=F,p.current=Object.assign(Object.assign({},p.current),{[r]:w}),()=>{B(),delete e[r],t.delete(r)}},[]),{swap:He((e,t)=>{N();const n=pe(i.current,r);De(n,e,t),B(n),De(R.current,e,t),E([...R.current]),g.current[r]&&De(g.current[r],e,t),b.current.touched&&v.current[r]&&De(v.current[r],e,t)},[]),move:He((e,t)=>{N();const n=pe(i.current,r);We(n,e,t),B(n),We(R.current,e,t),E([...R.current]),g.current[r]&&We(g.current[r],e,t),b.current.touched&&v.current[r]&&We(v.current[r],e,t)},[]),prepend:He(e=>{N(),B(),E(Ie(R.current,d(e)?V(e):[$e(e,t)])),g.current[r]&&(g.current[r]=Ie(g.current[r],Ue(e))),b.current.touched&&v.current[r]&&(v.current[r]=Ie(v.current[r],Ue(e)))},[]),append:He(e=>{N(),b.current.dirty&&(h.current=!0),E([...R.current,...d(e)?V(e):[$e(e,t)]])},[]),remove:He(e=>{if(l(e)||N(),B(Me(pe(i.current,r),e)),E(Me(R.current,e)),g.current[r]&&(g.current[r]=Me(g.current[r],e),g.current[r].filter(Boolean).length||delete g.current[r]),b.current.touched&&v.current[r]&&(v.current[r]=Me(v.current[r],e)),b.current.dirty&&m.current.forEach(t=>{(l(r)||t.startsWith(`${r}[${e}]`))&&m.current.delete(t)}),b.current.isValid&&!j){let t=-1,n=!1;const s=l(e);for(;t++<w.length;){const c=t===w.length-1,u=(d(e)?e:[e]).indexOf(t)>=0;if((u||s)&&(n=!0),n)for(const e in w[t]){const n=`${r}[${t}].${e}`;if(u||c||s)y.current.delete(n),O.current.delete(n);else{const s=`${r}[${t-1}].${e}`;y.current.has(n)&&y.current.add(s),O.current.has(n)&&O.current.add(s)}}}u()}},[w]),insert:He((e,n)=>{N(),B(Te(pe(i.current,r),e)),E(Te(R.current,e,d(n)?V(n):[$e(n,t)])),g.current[r]&&(g.current[r]=Te(g.current[r],e,Ue(n))),b.current.touched&&v.current[r]&&(v.current[r]=Te(v.current[r],e,Ue(n)))},[]),fields:w}};const Je=e=>{var{name:r,rules:t,as:o,onBlur:f,onChange:d,onChangeName:g=v.onChange,onBlurName:h=v.onBlur,valueName:b,defaultValue:p,control:y}=e,O=Ne(e,["name","rules","as","onBlur","onChange","onChangeName","onBlurName","valueName","defaultValue","control"]);const j=Ce(),{defaultValuesRef:S,setValue:w,register:x,unregister:R,errorsRef:V,removeFieldEventListener:E,triggerValidation:B,mode:{isOnSubmit:N,isOnBlur:F},reValidateMode:{isReValidateOnBlur:C,isReValidateOnSubmit:k},formState:{isSubmitted:L},fieldsRef:A,fieldArrayNamesRef:P}=y||j.control,[M,W]=s(l(p)?$(S.current,r):p),D=c(M),I=ue(M),T=()=>!be({hasError:!!$(V.current,r),isOnBlur:F,isOnSubmit:N,isReValidateOnBlur:C,isReValidateOnSubmit:k,isSubmitted:L}),U=e=>{const r=((e,r)=>ge(e)||!m(e.target)||m(e.target)&&!e.type?e:r||l(e.target.value)?e.target.checked:e.target.value)(e,I);return W(r),D.current=r,r},z=()=>{je(P.current,r)&&A.current[r]&&E(A.current[r],!0),x(Object.defineProperty({name:r},"value",{set(e){W(e),D.current=e},get:()=>D.current}),Object.assign({},t))};u(()=>{A.current[r]||(z(),W(l(p)?$(S.current,r):p))}),u(()=>(z(),()=>{je(P.current,r)||R(r)}),[r]),u(()=>{z()},[t]);const H=F||C,G=Object.assign(Object.assign(Object.assign(Object.assign({name:r},O),d?{[g]:(e=>(...t)=>w(r,U(e(t)),T()))(d)}:{[g]:e=>{const t=U(e);w(r,t,T())}}),f||H?{[h]:(...e)=>{f&&f(e),H&&B(r)}}:{}),{[b||(I?"checked":"value")]:M});return i(o)?a(o,G):n(o,G)},Ke=e=>{var{as:r,errors:t,name:s,message:c,children:u}=e,l=Ne(e,["as","errors","name","message","children"]);const f=Ce(),d=$(t||f.errors,s);if(!d)return null;const{message:g,types:m}=d,h=Object.assign(Object.assign({},r?l:{}),{children:u?u({message:g||c,messages:m}):g||c});return r?i(r)?a(r,h):n(r,h):n(o,Object.assign({},h))};export{Je as Controller,Ke as ErrorMessage,ke as FormContext,_e as useFieldArray,Be as useForm,Ce as useFormContext};
